package yagura.view;

import extension.helpers.SwingUtil;
import extension.view.base.CustomDialog;
import java.net.Proxy;
import javax.swing.JOptionPane;
import yagura.model.CertificateProperty;
import yagura.model.HttpExtendProperty;

/**
 *
 * @author isayan
 */
public class SendToServerExtendDlg extends CustomDialog {

    /**
     * Creates new form NewDialog
     *
     * @param parent
     * @param modal
     */
    public SendToServerExtendDlg(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        customizeComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnGrpHttpClientType = new javax.swing.ButtonGroup();
        btnGrpFormat = new javax.swing.ButtonGroup();
        pnlMain = new javax.swing.JPanel();
        pnlUseClient = new javax.swing.JPanel();
        rdoCustomClient = new javax.swing.JRadioButton();
        rdoBurpClient = new javax.swing.JRadioButton();
        pnlUseCustomClient = new javax.swing.JPanel();
        pnlCustomAuthorization = new javax.swing.JPanel();
        lblAuthorizationType = new javax.swing.JLabel();
        cmbAuthorizationType = new javax.swing.JComboBox<>();
        lblAuthorizationUser = new javax.swing.JLabel();
        txtAuthorizationUser = new javax.swing.JTextField();
        lblAuthorizationPasswd = new javax.swing.JLabel();
        txtAuthorizationPasswd = new javax.swing.JPasswordField();
        pnlCustomProxy = new javax.swing.JPanel();
        lblProtocol = new javax.swing.JLabel();
        lblProxyHost = new javax.swing.JLabel();
        lblProxyUser = new javax.swing.JLabel();
        lblProxyPasswd = new javax.swing.JLabel();
        txtProxyPasswd = new javax.swing.JPasswordField();
        txtProxyUser = new javax.swing.JTextField();
        txtProxyHost = new javax.swing.JTextField();
        cmbProtocol = new javax.swing.JComboBox<>();
        lblProxyPort = new javax.swing.JLabel();
        spnProxyPort = new javax.swing.JSpinner();
        pnlCertificate = new javax.swing.JPanel();
        pnlClientCertififate = new javax.swing.JPanel();
        pnlUseCertificate = new javax.swing.JPanel();
        chkClientCertififate = new javax.swing.JCheckBox();
        btnSelectExecute = new javax.swing.JButton();
        pnlServerCerficate = new javax.swing.JPanel();
        chkIgnoreValidateCertification = new javax.swing.JCheckBox();
        pnlApply = new javax.swing.JPanel();
        btnCancel = new javax.swing.JButton();
        btnOK = new javax.swing.JButton();

        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowClosing(java.awt.event.WindowEvent evt) {
                closeDialog(evt);
            }
        });

        pnlMain.setLayout(new java.awt.BorderLayout());

        btnGrpHttpClientType.add(rdoCustomClient);
        rdoCustomClient.setSelected(true);
        rdoCustomClient.setText("Use Custom http client");
        rdoCustomClient.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                rdoCustomClientStateChanged(evt);
            }
        });

        btnGrpHttpClientType.add(rdoBurpClient);
        rdoBurpClient.setText("Use Burp http client (with burp settings)");
        rdoBurpClient.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdoBurpClientActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnlUseClientLayout = new javax.swing.GroupLayout(pnlUseClient);
        pnlUseClient.setLayout(pnlUseClientLayout);
        pnlUseClientLayout.setHorizontalGroup(
            pnlUseClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlUseClientLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlUseClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(rdoBurpClient, javax.swing.GroupLayout.PREFERRED_SIZE, 272, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(rdoCustomClient))
                .addContainerGap(350, Short.MAX_VALUE))
        );
        pnlUseClientLayout.setVerticalGroup(
            pnlUseClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlUseClientLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(rdoBurpClient)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(rdoCustomClient)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pnlMain.add(pnlUseClient, java.awt.BorderLayout.NORTH);

        pnlUseCustomClient.setLayout(new java.awt.BorderLayout());

        pnlCustomAuthorization.setBorder(javax.swing.BorderFactory.createTitledBorder("Authorization"));

        lblAuthorizationType.setText("Authorization Type:");

        lblAuthorizationUser.setText("User:");

        lblAuthorizationPasswd.setText("Password:");

        txtAuthorizationPasswd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtAuthorizationPasswdActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnlCustomAuthorizationLayout = new javax.swing.GroupLayout(pnlCustomAuthorization);
        pnlCustomAuthorization.setLayout(pnlCustomAuthorizationLayout);
        pnlCustomAuthorizationLayout.setHorizontalGroup(
            pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                        .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblAuthorizationPasswd)
                            .addComponent(lblAuthorizationUser))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(txtAuthorizationUser)
                            .addComponent(txtAuthorizationPasswd, javax.swing.GroupLayout.PREFERRED_SIZE, 326, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                        .addComponent(lblAuthorizationType, javax.swing.GroupLayout.PREFERRED_SIZE, 112, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(cmbAuthorizationType, javax.swing.GroupLayout.PREFERRED_SIZE, 325, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(157, Short.MAX_VALUE))
        );
        pnlCustomAuthorizationLayout.setVerticalGroup(
            pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationType)
                    .addComponent(cmbAuthorizationType, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationUser)
                    .addComponent(txtAuthorizationUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationPasswd)
                    .addComponent(txtAuthorizationPasswd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        pnlUseCustomClient.add(pnlCustomAuthorization, java.awt.BorderLayout.NORTH);
        pnlCustomAuthorization.getAccessibleContext().setAccessibleDescription("");

        pnlCustomProxy.setBorder(javax.swing.BorderFactory.createTitledBorder("Proxy"));

        lblProtocol.setText("Protocol:");

        lblProxyHost.setText("Host:");

        lblProxyUser.setText("User:");

        lblProxyPasswd.setText("Password:");

        txtProxyPasswd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtProxyPasswdActionPerformed(evt);
            }
        });

        lblProxyPort.setText("port:");

        spnProxyPort.setModel(new javax.swing.SpinnerNumberModel(8080, 0, 65535, 1));
        spnProxyPort.setEditor(new javax.swing.JSpinner.NumberEditor(spnProxyPort, "#"));

        javax.swing.GroupLayout pnlCustomProxyLayout = new javax.swing.GroupLayout(pnlCustomProxy);
        pnlCustomProxy.setLayout(pnlCustomProxyLayout);
        pnlCustomProxyLayout.setHorizontalGroup(
            pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblProtocol, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblProxyHost, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblProxyPasswd)
                            .addComponent(lblProxyUser))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(txtProxyUser)
                    .addComponent(txtProxyHost, javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cmbProtocol, javax.swing.GroupLayout.Alignment.LEADING, 0, 371, Short.MAX_VALUE)
                    .addComponent(txtProxyPasswd))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblProxyPort, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(spnProxyPort, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 6, Short.MAX_VALUE))
        );
        pnlCustomProxyLayout.setVerticalGroup(
            pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProtocol)
                    .addComponent(cmbProtocol, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyHost)
                    .addComponent(txtProxyHost, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblProxyPort)
                    .addComponent(spnProxyPort, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyUser)
                    .addComponent(txtProxyUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyPasswd)
                    .addComponent(txtProxyPasswd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        pnlUseCustomClient.add(pnlCustomProxy, java.awt.BorderLayout.CENTER);

        pnlCertificate.setLayout(new java.awt.BorderLayout());

        pnlClientCertififate.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder("Client Certificate")));
        pnlClientCertififate.setLayout(new java.awt.BorderLayout());

        chkClientCertififate.setText("use Client Certififate");

        btnSelectExecute.setIcon(new javax.swing.ImageIcon(getClass().getResource("/yagura/resources/folder_image.png"))); // NOI18N
        btnSelectExecute.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSelectExecuteActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnlUseCertificateLayout = new javax.swing.GroupLayout(pnlUseCertificate);
        pnlUseCertificate.setLayout(pnlUseCertificateLayout);
        pnlUseCertificateLayout.setHorizontalGroup(
            pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlUseCertificateLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(chkClientCertififate)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnSelectExecute, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pnlUseCertificateLayout.setVerticalGroup(
            pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlUseCertificateLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(btnSelectExecute, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(chkClientCertififate, javax.swing.GroupLayout.Alignment.LEADING))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pnlClientCertififate.add(pnlUseCertificate, java.awt.BorderLayout.NORTH);

        pnlCertificate.add(pnlClientCertififate, java.awt.BorderLayout.PAGE_START);

        pnlServerCerficate.setBorder(javax.swing.BorderFactory.createTitledBorder("Server Cerficate"));
        pnlServerCerficate.setToolTipText("");

        chkIgnoreValidateCertification.setText("ignore Validate Certification");

        javax.swing.GroupLayout pnlServerCerficateLayout = new javax.swing.GroupLayout(pnlServerCerficate);
        pnlServerCerficate.setLayout(pnlServerCerficateLayout);
        pnlServerCerficateLayout.setHorizontalGroup(
            pnlServerCerficateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlServerCerficateLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(chkIgnoreValidateCertification)
                .addContainerGap(443, Short.MAX_VALUE))
        );
        pnlServerCerficateLayout.setVerticalGroup(
            pnlServerCerficateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlServerCerficateLayout.createSequentialGroup()
                .addComponent(chkIgnoreValidateCertification)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pnlCertificate.add(pnlServerCerficate, java.awt.BorderLayout.PAGE_END);

        pnlUseCustomClient.add(pnlCertificate, java.awt.BorderLayout.SOUTH);

        pnlMain.add(pnlUseCustomClient, java.awt.BorderLayout.CENTER);

        getContentPane().add(pnlMain, java.awt.BorderLayout.CENTER);

        pnlApply.setPreferredSize(new java.awt.Dimension(550, 50));

        btnCancel.setText("Cancel");
        btnCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelActionPerformed(evt);
            }
        });

        btnOK.setText("OK");
        btnOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnOKActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pnlApplyLayout = new javax.swing.GroupLayout(pnlApply);
        pnlApply.setLayout(pnlApplyLayout);
        pnlApplyLayout.setHorizontalGroup(
            pnlApplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlApplyLayout.createSequentialGroup()
                .addContainerGap(431, Short.MAX_VALUE)
                .addComponent(btnOK, javax.swing.GroupLayout.PREFERRED_SIZE, 84, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 95, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        pnlApplyLayout.setVerticalGroup(
            pnlApplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlApplyLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlApplyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnCancel)
                    .addComponent(btnOK))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        getContentPane().add(pnlApply, java.awt.BorderLayout.SOUTH);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private final java.util.ResourceBundle BUNDLE = java.util.ResourceBundle.getBundle("yagura/resources/Resource");

    private void btnCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelActionPerformed
        this.setModalResult(JOptionPane.CANCEL_OPTION);
        this.closeDialog(null);
    }//GEN-LAST:event_btnCancelActionPerformed

    private void btnOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnOKActionPerformed
        String proxyProtocol = (String) this.cmbProtocol.getSelectedItem();
        String proxyHost = this.txtProxyHost.getText().trim();
        if (!Proxy.Type.DIRECT.name().equals(proxyProtocol)) {
            if (proxyHost.isEmpty()) {
                JOptionPane.showMessageDialog(this, BUNDLE.getString("view.sendto.add.proxyhost.empty"), "SendTo", JOptionPane.INFORMATION_MESSAGE);
            } else {
                this.setModalResult(JOptionPane.OK_OPTION);
                this.closeDialog(null);
            }
        } else {
            this.setModalResult(JOptionPane.OK_OPTION);
            this.closeDialog(null);
        }
    }//GEN-LAST:event_btnOKActionPerformed

    private void txtProxyPasswdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtProxyPasswdActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtProxyPasswdActionPerformed

    private void rdoBurpClientActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdoBurpClientActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rdoBurpClientActionPerformed

    private void rdoCustomClientStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_rdoCustomClientStateChanged
        SwingUtil.setContainerEnable(this.pnlUseCustomClient, this.rdoCustomClient.isSelected());
    }//GEN-LAST:event_rdoCustomClientStateChanged

    private void txtAuthorizationPasswdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtAuthorizationPasswdActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtAuthorizationPasswdActionPerformed

    private void btnSelectExecuteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSelectExecuteActionPerformed
        this.showImportCertificatetDlg();
    }//GEN-LAST:event_btnSelectExecuteActionPerformed

    private final ImportCertificatetDlg importCertificatetDlg = new ImportCertificatetDlg(null, true);

    private final CertificateProperty certProp = new CertificateProperty();

    private void showImportCertificatetDlg() {
        this.importCertificatetDlg.setLocationRelativeTo(this);
        this.importCertificatetDlg.setVisible(true);
        if (this.importCertificatetDlg.getModalResult() == JOptionPane.OK_OPTION) {
            CertificateProperty prop = this.importCertificatetDlg.getProperty();
            this.certProp.setProperty(prop);
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                SendToServerExtendDlg dialog = new SendToServerExtendDlg(new java.awt.Frame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCancel;
    private javax.swing.ButtonGroup btnGrpFormat;
    private javax.swing.ButtonGroup btnGrpHttpClientType;
    private javax.swing.JButton btnOK;
    private javax.swing.JButton btnSelectExecute;
    private javax.swing.JCheckBox chkClientCertififate;
    private javax.swing.JCheckBox chkIgnoreValidateCertification;
    private javax.swing.JComboBox<String> cmbAuthorizationType;
    private javax.swing.JComboBox<String> cmbProtocol;
    private javax.swing.JLabel lblAuthorizationPasswd;
    private javax.swing.JLabel lblAuthorizationType;
    private javax.swing.JLabel lblAuthorizationUser;
    private javax.swing.JLabel lblProtocol;
    private javax.swing.JLabel lblProxyHost;
    private javax.swing.JLabel lblProxyPasswd;
    private javax.swing.JLabel lblProxyPort;
    private javax.swing.JLabel lblProxyUser;
    private javax.swing.JPanel pnlApply;
    private javax.swing.JPanel pnlCertificate;
    private javax.swing.JPanel pnlClientCertififate;
    private javax.swing.JPanel pnlCustomAuthorization;
    private javax.swing.JPanel pnlCustomProxy;
    private javax.swing.JPanel pnlMain;
    private javax.swing.JPanel pnlServerCerficate;
    private javax.swing.JPanel pnlUseCertificate;
    private javax.swing.JPanel pnlUseClient;
    private javax.swing.JPanel pnlUseCustomClient;
    private javax.swing.JRadioButton rdoBurpClient;
    private javax.swing.JRadioButton rdoCustomClient;
    private javax.swing.JSpinner spnProxyPort;
    private javax.swing.JPasswordField txtAuthorizationPasswd;
    private javax.swing.JTextField txtAuthorizationUser;
    private javax.swing.JTextField txtProxyHost;
    private javax.swing.JPasswordField txtProxyPasswd;
    private javax.swing.JTextField txtProxyUser;
    // End of variables declaration//GEN-END:variables

    @SuppressWarnings("unchecked")
    private void customizeComponents() {
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.NONE.name());
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.BASIC.name());
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.DIGEST.name());
        this.cmbProtocol.addItem(Proxy.Type.DIRECT.name());
        this.cmbProtocol.addItem(Proxy.Type.HTTP.name());
        this.cmbProtocol.addItem(Proxy.Type.SOCKS.name());
    }

    public void setProperty(HttpExtendProperty prop) {
        HttpExtendProperty.HttpClientType httpClientType = prop.getHttpClientType();
        HttpExtendProperty.AuthorizationType authorizationType = prop.getAuthorizationType();

        this.rdoCustomClient.setSelected(HttpExtendProperty.HttpClientType.CUSTOM.equals(httpClientType));

        String authorizationUser = prop.getAuthorizationUser();
        String authorizationPasswd = prop.getAuthorizationPasswd();
        this.cmbAuthorizationType.setSelectedItem(authorizationType.name());
        this.txtAuthorizationUser.setText(authorizationUser);
        this.txtAuthorizationPasswd.setText(authorizationPasswd);

        Proxy.Type proxyProtocol = prop.getProxyProtocol();
        String proxyHost = prop.getProxyHost();
        int proxyPort = prop.getProxyPort();
        String proxyUser = prop.getProxyUser();
        String proxyPasswd = prop.getProxyPasswd();
        boolean ignoreValidateCertification = prop.isIgnoreValidateCertification();

        this.cmbProtocol.setSelectedItem(proxyProtocol);
        this.txtProxyHost.setText(proxyHost);
        this.spnProxyPort.setValue(proxyPort);
        this.txtProxyUser.setText(proxyUser);
        this.txtProxyPasswd.setText(proxyPasswd);
        this.chkIgnoreValidateCertification.setSelected(ignoreValidateCertification);
        if (HttpExtendProperty.HttpClientType.CUSTOM.equals(httpClientType)) {
            this.rdoCustomClient.setSelected(true);
        } else {
            this.rdoBurpClient.setSelected(true);
        }
    }

    public HttpExtendProperty getProperty() {
        HttpExtendProperty prop = new HttpExtendProperty();
        HttpExtendProperty.HttpClientType httpClientType = this.rdoCustomClient.isSelected() ? HttpExtendProperty.HttpClientType.CUSTOM : HttpExtendProperty.HttpClientType.BURP;
        prop.setHttpClientType(httpClientType);

        prop.setUseClientCertificate(this.chkClientCertififate.isSelected());
        prop.setClientCertificateStoreType(this.certProp.getStoreType());
        prop.setClientCertificate(this.certProp.getClientCertificate());
        prop.setClientCertificatePasswd(this.certProp.getClientCertificatePasswd());

        prop.setIgnoreValidateCertification(this.chkIgnoreValidateCertification.isSelected());

        prop.setAuthorizationType(HttpExtendProperty.AuthorizationType.valueOf((String) this.cmbAuthorizationType.getSelectedItem()));
        prop.setAuthorizationUser(this.txtAuthorizationUser.getText());
        prop.setAuthorizationPasswd(String.valueOf(this.txtAuthorizationPasswd.getPassword()));

        prop.setProxyProtocol(Proxy.Type.valueOf((String) (String) this.cmbProtocol.getSelectedItem()));
        prop.setProxyHost(this.txtProxyHost.getText());
        prop.setProxyPort((int) this.spnProxyPort.getValue());
        prop.setProxyUser(this.txtProxyUser.getText());
        prop.setProxyPasswd(String.valueOf(this.txtProxyPasswd.getPassword()));
        return prop;
    }

}

package yagura.view;

import extension.helpers.SwingUtil;
import extension.view.base.CustomTableModel;
import java.net.Proxy;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import yagura.model.CertificateItem;
import yagura.model.HttpExtendProperty;

/**
 *
 * @author isayan
 */
public class ConnectionsPanel extends javax.swing.JPanel {

    private final static java.util.ResourceBundle BUNDLE = java.util.ResourceBundle.getBundle("yagura/resources/Resource");

    /**
     * Creates new form ConnectionPanel
     */
    public ConnectionsPanel() {
        initComponents();
        customizeComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        btnGrpHttpClientType = new javax.swing.ButtonGroup();
        rdoGrpHttpProtocol = new javax.swing.ButtonGroup();
        pnlUseClient = new javax.swing.JPanel();
        pnlHttpClient = new javax.swing.JPanel();
        rdoBurpClient = new javax.swing.JRadioButton();
        rdoCustomClient = new javax.swing.JRadioButton();
        pnlHttpProtocol = new javax.swing.JPanel();
        rdoHttpProtocolAuto = new javax.swing.JRadioButton();
        rdoHttpProtocol1 = new javax.swing.JRadioButton();
        rdoHttpProtocol2 = new javax.swing.JRadioButton();
        pnlUseCustomClient = new javax.swing.JPanel();
        pnlTimeout = new javax.swing.JPanel();
        spnTimeout = new javax.swing.JSpinner();
        lblAuthorizationType1 = new javax.swing.JLabel();
        pnlCustom = new javax.swing.JPanel();
        pnlCustomAuthorization = new javax.swing.JPanel();
        lblAuthorizationType = new javax.swing.JLabel();
        cmbAuthorizationType = new javax.swing.JComboBox<>();
        lblAuthorizationUser = new javax.swing.JLabel();
        txtAuthorizationUser = new javax.swing.JTextField();
        lblAuthorizationPasswd = new javax.swing.JLabel();
        txtAuthorizationPasswd = new javax.swing.JPasswordField();
        pnlCustomProxy = new javax.swing.JPanel();
        lblProtocol = new javax.swing.JLabel();
        lblProxyHost = new javax.swing.JLabel();
        lblProxyUser = new javax.swing.JLabel();
        lblProxyPasswd = new javax.swing.JLabel();
        txtProxyPasswd = new javax.swing.JPasswordField();
        txtProxyUser = new javax.swing.JTextField();
        txtProxyHost = new javax.swing.JTextField();
        cmbProtocol = new javax.swing.JComboBox<>();
        lblProxyPort = new javax.swing.JLabel();
        spnProxyPort = new javax.swing.JSpinner();
        pnlCertificate = new javax.swing.JPanel();
        pnlClientCertififate = new javax.swing.JPanel();
        pnlUseCertificate = new javax.swing.JPanel();
        chkClientCertififate = new javax.swing.JCheckBox();
        btnSelectExecute = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableCertificate = new javax.swing.JTable();
        pnlServerCerficate = new javax.swing.JPanel();
        chkIgnoreValidateCertification = new javax.swing.JCheckBox();

        setLayout(new java.awt.BorderLayout());

        pnlUseClient.setLayout(new java.awt.BorderLayout());

        btnGrpHttpClientType.add(rdoBurpClient);
        rdoBurpClient.setText("Use Burp http client (with burp settings)");

        btnGrpHttpClientType.add(rdoCustomClient);
        rdoCustomClient.setSelected(true);
        rdoCustomClient.setText("Use Custom http client");
        rdoCustomClient.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                rdoCustomClientStateChanged(evt);
            }
        });

        javax.swing.GroupLayout pnlHttpClientLayout = new javax.swing.GroupLayout(pnlHttpClient);
        pnlHttpClient.setLayout(pnlHttpClientLayout);
        pnlHttpClientLayout.setHorizontalGroup(
            pnlHttpClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlHttpClientLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlHttpClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(rdoBurpClient)
                    .addComponent(rdoCustomClient))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pnlHttpClientLayout.setVerticalGroup(
            pnlHttpClientLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlHttpClientLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(rdoBurpClient)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(rdoCustomClient)
                .addContainerGap())
        );

        pnlUseClient.add(pnlHttpClient, java.awt.BorderLayout.CENTER);

        pnlHttpProtocol.setBorder(javax.swing.BorderFactory.createTitledBorder("Protocol"));
        pnlHttpProtocol.setLayout(new java.awt.GridLayout(1, 3));

        rdoGrpHttpProtocol.add(rdoHttpProtocolAuto);
        rdoHttpProtocolAuto.setSelected(true);
        rdoHttpProtocolAuto.setText("Auto");
        pnlHttpProtocol.add(rdoHttpProtocolAuto);

        rdoGrpHttpProtocol.add(rdoHttpProtocol1);
        rdoHttpProtocol1.setText("HTTP/1.1");
        pnlHttpProtocol.add(rdoHttpProtocol1);

        rdoGrpHttpProtocol.add(rdoHttpProtocol2);
        rdoHttpProtocol2.setText("HTTP/2");
        pnlHttpProtocol.add(rdoHttpProtocol2);

        pnlUseClient.add(pnlHttpProtocol, java.awt.BorderLayout.EAST);

        add(pnlUseClient, java.awt.BorderLayout.NORTH);

        pnlUseCustomClient.setLayout(new java.awt.BorderLayout());

        pnlTimeout.setBorder(javax.swing.BorderFactory.createTitledBorder("Timeout"));

        spnTimeout.setModel(new javax.swing.SpinnerNumberModel(120, 0, 9999, 1));

        lblAuthorizationType1.setText("Connection/Read/Write:");

        javax.swing.GroupLayout pnlTimeoutLayout = new javax.swing.GroupLayout(pnlTimeout);
        pnlTimeout.setLayout(pnlTimeoutLayout);
        pnlTimeoutLayout.setHorizontalGroup(
            pnlTimeoutLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, pnlTimeoutLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblAuthorizationType1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(spnTimeout, javax.swing.GroupLayout.PREFERRED_SIZE, 111, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(286, Short.MAX_VALUE))
        );
        pnlTimeoutLayout.setVerticalGroup(
            pnlTimeoutLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlTimeoutLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlTimeoutLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(spnTimeout, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblAuthorizationType1))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pnlUseCustomClient.add(pnlTimeout, java.awt.BorderLayout.NORTH);

        pnlCustom.setLayout(new java.awt.BorderLayout());

        pnlCustomAuthorization.setBorder(javax.swing.BorderFactory.createTitledBorder("Authorization"));

        lblAuthorizationType.setText("Authorization Type:");

        lblAuthorizationUser.setText("User:");

        lblAuthorizationPasswd.setText("Password:");

        javax.swing.GroupLayout pnlCustomAuthorizationLayout = new javax.swing.GroupLayout(pnlCustomAuthorization);
        pnlCustomAuthorization.setLayout(pnlCustomAuthorizationLayout);
        pnlCustomAuthorizationLayout.setHorizontalGroup(
            pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblAuthorizationPasswd)
                    .addComponent(lblAuthorizationUser)
                    .addComponent(lblAuthorizationType))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cmbAuthorizationType, 0, 1, Short.MAX_VALUE)
                    .addComponent(txtAuthorizationUser)
                    .addComponent(txtAuthorizationPasswd))
                .addGap(213, 213, 213))
        );
        pnlCustomAuthorizationLayout.setVerticalGroup(
            pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomAuthorizationLayout.createSequentialGroup()
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationType)
                    .addComponent(cmbAuthorizationType, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationUser)
                    .addComponent(txtAuthorizationUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomAuthorizationLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblAuthorizationPasswd)
                    .addComponent(txtAuthorizationPasswd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        pnlCustom.add(pnlCustomAuthorization, java.awt.BorderLayout.NORTH);

        pnlCustomProxy.setBorder(javax.swing.BorderFactory.createTitledBorder("Proxy"));

        lblProtocol.setText("Protocol:");

        lblProxyHost.setText("Host:");

        lblProxyUser.setText("User:");

        lblProxyPasswd.setText("Password:");

        lblProxyPort.setText("port:");

        spnProxyPort.setModel(new javax.swing.SpinnerNumberModel(8080, 0, 65535, 1));
        spnProxyPort.setEditor(new javax.swing.JSpinner.NumberEditor(spnProxyPort, "#"));

        javax.swing.GroupLayout pnlCustomProxyLayout = new javax.swing.GroupLayout(pnlCustomProxy);
        pnlCustomProxy.setLayout(pnlCustomProxyLayout);
        pnlCustomProxyLayout.setHorizontalGroup(
            pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lblProtocol)
                    .addComponent(lblProxyHost)
                    .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblProxyPasswd)
                            .addComponent(lblProxyUser))))
                .addGap(50, 50, 50)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtProxyHost)
                    .addComponent(txtProxyPasswd, javax.swing.GroupLayout.DEFAULT_SIZE, 291, Short.MAX_VALUE)
                    .addComponent(txtProxyUser, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(cmbProtocol, 0, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lblProxyPort)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(spnProxyPort, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pnlCustomProxyLayout.setVerticalGroup(
            pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlCustomProxyLayout.createSequentialGroup()
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProtocol)
                    .addComponent(cmbProtocol, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyHost)
                    .addComponent(txtProxyHost, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblProxyPort)
                    .addComponent(spnProxyPort, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyUser)
                    .addComponent(txtProxyUser, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(pnlCustomProxyLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lblProxyPasswd)
                    .addComponent(txtProxyPasswd, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(27, Short.MAX_VALUE))
        );

        pnlCustom.add(pnlCustomProxy, java.awt.BorderLayout.CENTER);

        pnlUseCustomClient.add(pnlCustom, java.awt.BorderLayout.CENTER);

        pnlCertificate.setLayout(new java.awt.BorderLayout());

        pnlClientCertififate.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder("Client Certificate")));
        pnlClientCertififate.setLayout(new java.awt.BorderLayout());

        chkClientCertififate.setText("use Client Certififate");

        btnSelectExecute.setIcon(new javax.swing.ImageIcon(getClass().getResource("/yagura/resources/folder_page.png"))); // NOI18N
        btnSelectExecute.setMaximumSize(new java.awt.Dimension(30, 30));
        btnSelectExecute.setMinimumSize(new java.awt.Dimension(30, 30));
        btnSelectExecute.setPreferredSize(new java.awt.Dimension(30, 30));
        btnSelectExecute.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSelectExecuteActionPerformed(evt);
            }
        });

        tableCertificate.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "", "StoreType", "Certificate", "CertificatePassword", "Subject"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Boolean.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane1.setViewportView(tableCertificate);

        javax.swing.GroupLayout pnlUseCertificateLayout = new javax.swing.GroupLayout(pnlUseCertificate);
        pnlUseCertificate.setLayout(pnlUseCertificateLayout);
        pnlUseCertificateLayout.setHorizontalGroup(
            pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlUseCertificateLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1)
                    .addGroup(pnlUseCertificateLayout.createSequentialGroup()
                        .addComponent(chkClientCertififate)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnSelectExecute, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 361, Short.MAX_VALUE)))
                .addContainerGap())
        );
        pnlUseCertificateLayout.setVerticalGroup(
            pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlUseCertificateLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(pnlUseCertificateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnSelectExecute, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(chkClientCertififate, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 90, Short.MAX_VALUE)
                .addContainerGap())
        );

        pnlClientCertififate.add(pnlUseCertificate, java.awt.BorderLayout.NORTH);

        pnlCertificate.add(pnlClientCertififate, java.awt.BorderLayout.PAGE_START);

        pnlServerCerficate.setBorder(javax.swing.BorderFactory.createTitledBorder("Server Cerficate"));
        pnlServerCerficate.setToolTipText("");

        chkIgnoreValidateCertification.setText("ignore Validate Certification");

        javax.swing.GroupLayout pnlServerCerficateLayout = new javax.swing.GroupLayout(pnlServerCerficate);
        pnlServerCerficate.setLayout(pnlServerCerficateLayout);
        pnlServerCerficateLayout.setHorizontalGroup(
            pnlServerCerficateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlServerCerficateLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(chkIgnoreValidateCertification)
                .addContainerGap(362, Short.MAX_VALUE))
        );
        pnlServerCerficateLayout.setVerticalGroup(
            pnlServerCerficateLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pnlServerCerficateLayout.createSequentialGroup()
                .addComponent(chkIgnoreValidateCertification)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pnlCertificate.add(pnlServerCerficate, java.awt.BorderLayout.PAGE_END);

        pnlUseCustomClient.add(pnlCertificate, java.awt.BorderLayout.SOUTH);

        add(pnlUseCustomClient, java.awt.BorderLayout.CENTER);
    }// </editor-fold>//GEN-END:initComponents

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                JFrame frame = new javax.swing.JFrame();
                ConnectionsPanel panel = new ConnectionsPanel();
                frame.add(panel);
                frame.addWindowListener(new java.awt.event.WindowAdapter() {
                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                frame.pack();
                frame.setVisible(true);
            }
        });
    }

    public boolean isValidation() {
        String proxyProtocol = (String) this.cmbProtocol.getSelectedItem();
        String proxyHost = this.txtProxyHost.getText().trim();
        if (!Proxy.Type.DIRECT.name().equals(proxyProtocol)) {
            if (proxyHost.isEmpty()) {
                JOptionPane.showMessageDialog(this, BUNDLE.getString("view.sendto.add.proxyhost.empty"), "SendTo", JOptionPane.INFORMATION_MESSAGE);
            } else {
                return true;
            }
        } else {
            return true;
        }
        return false;
    }

    private void rdoCustomClientStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_rdoCustomClientStateChanged
        SwingUtil.setContainerEnable(this.pnlUseCustomClient, this.rdoCustomClient.isSelected());
        this.chkClientCertififate.setEnabled(this.modelCertificate.getRowCount() > 0);
    }//GEN-LAST:event_rdoCustomClientStateChanged

    private void btnSelectExecuteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSelectExecuteActionPerformed
        this.showImportCertificatetDlg();
    }//GEN-LAST:event_btnSelectExecuteActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup btnGrpHttpClientType;
    private javax.swing.JButton btnSelectExecute;
    private javax.swing.JCheckBox chkClientCertififate;
    private javax.swing.JCheckBox chkIgnoreValidateCertification;
    private javax.swing.JComboBox<String> cmbAuthorizationType;
    private javax.swing.JComboBox<String> cmbProtocol;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblAuthorizationPasswd;
    private javax.swing.JLabel lblAuthorizationType;
    private javax.swing.JLabel lblAuthorizationType1;
    private javax.swing.JLabel lblAuthorizationUser;
    private javax.swing.JLabel lblProtocol;
    private javax.swing.JLabel lblProxyHost;
    private javax.swing.JLabel lblProxyPasswd;
    private javax.swing.JLabel lblProxyPort;
    private javax.swing.JLabel lblProxyUser;
    private javax.swing.JPanel pnlCertificate;
    private javax.swing.JPanel pnlClientCertififate;
    private javax.swing.JPanel pnlCustom;
    private javax.swing.JPanel pnlCustomAuthorization;
    private javax.swing.JPanel pnlCustomProxy;
    private javax.swing.JPanel pnlHttpClient;
    private javax.swing.JPanel pnlHttpProtocol;
    private javax.swing.JPanel pnlServerCerficate;
    private javax.swing.JPanel pnlTimeout;
    private javax.swing.JPanel pnlUseCertificate;
    private javax.swing.JPanel pnlUseClient;
    private javax.swing.JPanel pnlUseCustomClient;
    private javax.swing.JRadioButton rdoBurpClient;
    private javax.swing.JRadioButton rdoCustomClient;
    private javax.swing.ButtonGroup rdoGrpHttpProtocol;
    private javax.swing.JRadioButton rdoHttpProtocol1;
    private javax.swing.JRadioButton rdoHttpProtocol2;
    private javax.swing.JRadioButton rdoHttpProtocolAuto;
    private javax.swing.JSpinner spnProxyPort;
    private javax.swing.JSpinner spnTimeout;
    private javax.swing.JTable tableCertificate;
    private javax.swing.JPasswordField txtAuthorizationPasswd;
    private javax.swing.JTextField txtAuthorizationUser;
    private javax.swing.JTextField txtProxyHost;
    private javax.swing.JPasswordField txtProxyPasswd;
    private javax.swing.JTextField txtProxyUser;
    // End of variables declaration//GEN-END:variables

    private CustomTableModel modelCertificate = null;

    private void customizeComponents() {
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.NONE.name());
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.BASIC.name());
        this.cmbAuthorizationType.addItem(HttpExtendProperty.AuthorizationType.DIGEST.name());
        this.cmbProtocol.addItem(Proxy.Type.DIRECT.name());
        this.cmbProtocol.addItem(Proxy.Type.HTTP.name());
        this.cmbProtocol.addItem(Proxy.Type.SOCKS.name());

        this.modelCertificate = new CustomTableModel(this.tableCertificate.getModel());
        this.tableCertificate.setModel(this.modelCertificate);
        this.tableCertificate.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
        this.tableCertificate.setFillsViewportHeight(true);

        // selected
        this.tableCertificate.getColumnModel().getColumn(0).setMinWidth(20);
        this.tableCertificate.getColumnModel().getColumn(0).setPreferredWidth(20);
        this.tableCertificate.getColumnModel().getColumn(0).setMaxWidth(30);

        // StoreType
        this.tableCertificate.getColumnModel().getColumn(1).setMinWidth(40);
        this.tableCertificate.getColumnModel().getColumn(1).setPreferredWidth(80);
        this.tableCertificate.getColumnModel().getColumn(1).setMaxWidth(120);

        //
        this.tableCertificate.getColumnModel().getColumn(2).setMinWidth(0);
        this.tableCertificate.getColumnModel().getColumn(2).setPreferredWidth(0);
        this.tableCertificate.getColumnModel().getColumn(2).setMaxWidth(0);

        // password
        this.tableCertificate.getColumnModel().getColumn(3).setMinWidth(0);
        this.tableCertificate.getColumnModel().getColumn(3).setPreferredWidth(0);
        this.tableCertificate.getColumnModel().getColumn(3).setMaxWidth(0);

        this.chkClientCertififate.setEnabled(this.modelCertificate.getRowCount() > 0);
    }

    private final ImportCertificatetDlg importCertificatetDlg = new ImportCertificatetDlg(null, true);

    private final CertificateItem certProp = new CertificateItem();

    private void showImportCertificatetDlg() {
        this.importCertificatetDlg.setLocationRelativeTo(this);
        this.importCertificatetDlg.setVisible(true);
        if (this.importCertificatetDlg.getModalResult() == JOptionPane.OK_OPTION) {
            CertificateItem prop = this.importCertificatetDlg.getProperty();
            this.clearItem();
            this.certProp.setProperty(prop);
            this.setEditItem(this.certProp, false);
            this.chkClientCertififate.setEnabled(this.modelCertificate.getRowCount() > 0);
        }
    }

    private void clearItem() {
        this.certProp.setSelected(false);
        this.modelCertificate.removeAll();
    }

    private CertificateItem getEditItem() {
        CertificateItem item = new CertificateItem();
        Object editCols[] = SwingUtil.editItem(this.tableCertificate);
        if (editCols != null) {
            item = CertificateItem.fromObjects(editCols);
        }
        return item;
    }

    private void setEditItem(CertificateItem item, boolean update) {
        Object[] rows = CertificateItem.toObjects(item);
        SwingUtil.addOrUpdateItem(this.tableCertificate, rows, update);
    }

    public HttpExtendProperty.HttpClientType getHttpClientType() {
        return this.rdoCustomClient.isSelected() ? HttpExtendProperty.HttpClientType.CUSTOM : HttpExtendProperty.HttpClientType.BURP;
    }

    public HttpExtendProperty.HttpProtocol getHttpProtocol() {
        HttpExtendProperty.HttpProtocol httpProtocol = HttpExtendProperty.HttpProtocol.AUTO;
        if (this.rdoHttpProtocol1.isSelected()) {
            httpProtocol = HttpExtendProperty.HttpProtocol.HTTP_1_1;
        } else if (this.rdoHttpProtocol2.isSelected()) {
            httpProtocol = HttpExtendProperty.HttpProtocol.HTTP_2;
        }
        return httpProtocol;
    }

    public void setProperty(HttpExtendProperty prop) {
        HttpExtendProperty.HttpClientType httpClientType = prop.getHttpClientType();
        HttpExtendProperty.AuthorizationType authorizationType = prop.getAuthorizationType();
        HttpExtendProperty.HttpProtocol httpProtocol = prop.getHttpProtocol();

        if (HttpExtendProperty.HttpClientType.CUSTOM.equals(httpClientType)) {
            this.rdoCustomClient.setSelected(true);
        } else {
            this.rdoBurpClient.setSelected(true);
        }
        switch (httpProtocol) {
            case HTTP_1_1: {
                this.rdoHttpProtocol1.setSelected(true);
                break;
            }
            case HTTP_2: {
                this.rdoHttpProtocol2.setSelected(true);
                break;
            }
            default: {
                this.rdoHttpProtocolAuto.setSelected(true);
                break;
            }
        }

        this.spnTimeout.setValue(prop.getTimeout());

        String authorizationUser = prop.getAuthorizationUser();
        String authorizationPasswd = prop.getAuthorizationPasswd();
        this.cmbAuthorizationType.setSelectedItem(authorizationType.name());
        this.txtAuthorizationUser.setText(authorizationUser);
        this.txtAuthorizationPasswd.setText(authorizationPasswd);

        Proxy.Type proxyProtocol = prop.getProxyProtocol();
        String proxyHost = prop.getProxyHost();
        int proxyPort = prop.getProxyPort();
        String proxyUser = prop.getProxyUser();
        String proxyPasswd = prop.getProxyPasswd();
        boolean ignoreValidateCertification = prop.isIgnoreValidateCertification();

        this.cmbProtocol.setSelectedItem(proxyProtocol.name());
        this.txtProxyHost.setText(proxyHost);
        this.spnProxyPort.setValue(proxyPort);
        this.txtProxyUser.setText(proxyUser);
        this.txtProxyPasswd.setText(proxyPasswd);
        this.chkIgnoreValidateCertification.setSelected(ignoreValidateCertification);

        this.clearItem();
        this.chkClientCertififate.setSelected(prop.isUseClientCertificate());
        if (this.chkClientCertififate.isSelected()) {
            CertificateItem item = prop.getClientCertificateItem();
            setEditItem(item, false);
        }
        this.chkClientCertififate.setEnabled(this.modelCertificate.getRowCount() > 0);
    }

    public HttpExtendProperty getHttpExtendProperty() {
        HttpExtendProperty prop = new HttpExtendProperty();
        prop.setHttpClientType(this.getHttpClientType());
        prop.setHttpProtocol(this.getHttpProtocol());

        prop.setTimeout((int) this.spnTimeout.getValue());

        prop.setAuthorizationType(HttpExtendProperty.AuthorizationType.valueOf((String) this.cmbAuthorizationType.getSelectedItem()));
        prop.setAuthorizationUser(this.txtAuthorizationUser.getText());
        prop.setAuthorizationPasswd(String.valueOf(this.txtAuthorizationPasswd.getPassword()));

        prop.setProxyProtocol(Proxy.Type.valueOf((String) (String) this.cmbProtocol.getSelectedItem()));
        prop.setProxyHost(this.txtProxyHost.getText());
        prop.setProxyPort((int) this.spnProxyPort.getValue());
        prop.setProxyUser(this.txtProxyUser.getText());
        prop.setProxyPasswd(String.valueOf(this.txtProxyPasswd.getPassword()));

        prop.setUseClientCertificate(this.chkClientCertififate.isSelected());
        if (prop.isUseClientCertificate()) {
            prop.setClientCertificateStoreType(this.certProp.getStoreType());
            prop.setClientCertificate(this.certProp.getClientCertificate());
            prop.setClientCertificatePasswd(this.certProp.getClientCertificatePasswd());
        }
        prop.setIgnoreValidateCertification(this.chkIgnoreValidateCertification.isSelected());
        return prop;
    }

}
